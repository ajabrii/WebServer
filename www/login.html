<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Login or Register</title>
  <script>
    window.onload = function () {
      if (document.cookie.indexOf("PHPSESSID=") !== -1) {
        fetch("cgi-bin/session_check.php")
          .then(res => res.json())
          .then(data => {
            if (data.loggedIn) {
              window.location.href = "cgi-bin/welcome.php";
            }
          });
      }
    };

    function login() {
      const user = document.getElementById("login_user").value;
      const pass = document.getElementById("login_pass").value;
      if (!user || !pass) {
        alert("Fill username and password");
        return;
      }
      window.location.href = `cgi-bin/login.php?username=${encodeURIComponent(user)}&password=${encodeURIComponent(pass)}`;
    }

    function register() {
      const user = document.getElementById("reg_user").value;
      const pass = document.getElementById("reg_pass").value;
      if (!user || !pass) {
        alert("Fill username and password");
        return;
      }
      window.location.href = `cgi-bin/register.php?username=${encodeURIComponent(user)}&password=${encodeURIComponent(pass)}`;
    }
  </script>
</head>
<body>
  <h2>Login</h2>
  <input type="text" id="login_user" placeholder="Username"><br>
  <input type="password" id="login_pass" placeholder="Password"><br>
  <button onclick="login()">Login</button>

  <h2>Register</h2>
  <input type="text" id="reg_user" placeholder="New Username"><br>
  <input type="password" id="reg_pass" placeholder="New Password"><br>
  <button onclick="register()">Register</button>
</body>
</html>
